# WanVACE Gradio界面使用说明

这是一个基于Gradio的WanVACE视频生成器Web界面，让用户可以通过浏览器轻松使用Wan2.1-VACE-14B模型生成高质量视频。

## 🚀 快速开始

### 方法1：使用启动脚本（推荐）
```bash
./run_gradio.sh
```

### 方法2：手动启动
```bash
# 安装依赖
pip install -r requirements.txt

# 安装diffsynth
git clone https://github.com/modelscope/DiffSynth-Studio.git  
cd DiffSynth-Studio
pip install -e .

# 启动界面
python main.py
```

## 🌐 界面功能

### 1. 输入设置
- **深度视频上传**：支持上传MP4等格式的视频文件
- **参考图片上传**：支持上传JPG、PNG等格式的图片
- **智能检测**：系统自动检测上传的文件类型，无需手动选择

### 2. 参数设置
- **正面提示词**：描述想要生成的视频内容
- **负面提示词**：描述不想要的内容和风格
- **随机种子**：控制生成结果的随机性（-1为随机，或指定1-999999）
- **FPS**：输出视频的帧率（1-60）
- **宽高比**：选择预设的宽高比（1:1、4:3、16:9、9:16等）
- **视频高度**：输出视频的高度（256-1280像素，建议64的倍数）
- **视频宽度**：输出视频的宽度（256-1280像素，建议64的倍数）
- **质量**：输出视频的质量等级（1-10，10为最高质量）

### 3. 显存管理
- **释放显存**：清理GPU显存，适用于调试中断后
- **刷新显存信息**：查看当前显存使用情况
- **显存监控**：实时监控显存分配和保留状态

### 4. 操作流程
1. 上传深度视频和/或参考图片（系统自动检测）
2. 设置生成参数
3. 点击"🎬 生成视频"开始处理（首次使用会自动初始化模型）
4. 等待生成完成，下载结果视频

## 📁 文件结构

```
wanvace/
├── main.py                # Gradio界面主文件
├── requirements.txt       # 依赖包列表
├── README.md      # 本说明文档
```

## ⚠️ 注意事项

1. **硬件要求**：需要CUDA支持的GPU，建议至少8GB显存
2. **首次使用**：第一次运行需要下载模型文件，请耐心等待
3. **处理时间**：视频生成需要较长时间，取决于视频长度和参数设置
4. **文件大小**：建议使用较小的视频文件以提高处理速度
5. **网络访问**：界面默认在 http://localhost:7860 启动，支持公网分享

## 🔧 故障排除

### 常见问题
1. **CUDA错误**：确保已安装CUDA和PyTorch
2. **内存不足**：减少视频分辨率或使用更小的模型
3. **依赖缺失**：运行 `pip install -r requirements.txt`
4. **端口占用**：修改 `main.py` 中的端口号
5. **视频尺寸错误**：确保深度视频尺寸与目标尺寸兼容，建议使用相近的宽高比

### 获取帮助
如果遇到问题，请检查：
- Python版本（建议3.8+）
- PyTorch版本和CUDA兼容性
- 显存是否足够
- 模型文件是否完整

## 📝 示例用法

### 基础用法
1. 上传一个深度视频
2. 设置提示词："一只可爱的小猫在花园里玩耍"
3. 设置FPS=24，质量=8
4. 点击生成

### 高级用法
1. 同时使用深度视频和参考图片
2. 自定义负面提示词避免特定问题
3. 调整种子值获得不同风格的结果
4. 结合不同的FPS和质量设置
5. 自定义视频尺寸以适应不同需求
6. 使用64的倍数尺寸以获得最佳性能

## 🎯 技术特性

- 基于Wan2.1-VACE-14B模型
- 支持深度视频控制
- 支持参考图片引导
- 可调节的FPS和质量参数
- 友好的Web界面
- 实时状态反馈
- 支持多种输入格式
